# üìã –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï (–¢–ó)

## Network Traffic Monitoring & Analytics Feature –¥–ª—è SysMetrics Pro

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** December 19, 2025  
**–°—Ç–∞—Ç—É—Å:** Design Phase  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** High  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Medium-High

---

## 1. –û–ë–ó–û–† –ò –¶–ï–õ–¨

### 1.1 –û—Å–Ω–æ–≤–Ω–∞—è –¶–µ–ª—å
–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ SysMetrics Pro —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º:
- **–í—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ (Ingress)** - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **–ò—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ (Egress)** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** (Peak usage)
- **–¢–µ–∫—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** (Real-time)
- **Per-app —Ç—Ä–∞—Ñ–∏–∫–∞** (–∫–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–∫–æ–ª—å–∫–æ –µ—Å—Ç)
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏** (CPU, RAM, Network –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)

### 1.2 –ö–æ–Ω—Ç–µ–∫—Å—Ç
SysMetrics Pro —è–≤–ª—è–µ—Ç—Å—è production-ready tool –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. Network Traffic Monitoring —Ä–∞—Å—à–∏—Ä–∏—Ç –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤, –≤–∫–ª—é—á–∞—è —Å–µ—Ç–µ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

### 1.3 –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å
- –ü–æ–º–æ—â—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –≤ –æ—Ç–ª–∞–¥–∫–µ network-related issues
- –í—ã—è–≤–ª–µ–Ω–∏–µ —É—Ç–µ—á–µ–∫ —Ç—Ä–∞—Ñ–∏–∫–∞ (background —Å–µ—Ä–≤–∏—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –µ–¥—è—Ç –¥–∞–Ω–Ω—ã–µ)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –≤—ã—Å–æ–∫–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ—Ç–∏
- –ü–æ–º–æ—â—å QA –∫–æ–º–∞–Ω–¥–∞–º –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –¶–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

---

## 2. –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### 2.1 –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### 2.1.1 Real-Time Traffic Monitoring
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–µ—Ç–µ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–î–µ—Ç–∞–ª–∏:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π Ingress (‚Üì) –≤ Mbps/kbps
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π Egress (‚Üë) –≤ Mbps/kbps
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 500ms / 1s / 2s (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- –¢–æ—á–Ω–æ—Å—Ç—å: ¬±5% –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ: –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π

**–ü—Ä–∏–º–µ—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
```
‚Üì 2.5 Mbps (Ingress)
‚Üë 0.8 Mbps (Egress)
```

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:** `/proc/net/dev` (Linux —Å—Ç–∞–Ω–¥–∞—Ä—Ç)

---

#### 2.1.2 Peak Usage Tracking
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞ —Å–µ—Å—Å–∏—é

**–î–µ—Ç–∞–ª–∏:**
- –•—Ä–∞–Ω–∏—Ç—å Peak Ingress —Å timestamp'–æ–º
- –•—Ä–∞–Ω–∏—Ç—å Peak Egress —Å timestamp'–æ–º
- Reset –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ SharedPreferences –¥–ª—è persistence

**–ü—Ä–∏–º–µ—Ä—ã:**
```
Peak ‚Üì: 25.3 Mbps (14:23:45)
Peak ‚Üë: 12.1 Mbps (14:22:10)
```

---

#### 2.1.3 Per-App Traffic Analysis
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–∫–æ–ª—å–∫–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç

**–î–µ—Ç–∞–ª–∏:**
- Top 5 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ Top 10)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è + icon
- Total bytes sent/received –∑–∞ —Å–µ—Å—Å–∏—é
- –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ app

**–ü—Ä–∏–º–µ—Ä—ã:**
```
üé¨ YouTube - ‚Üì 1.5MB/s (‚Üë 50KB/s)
üì± Telegram - ‚Üì 200KB/s (‚Üë 100KB/s)
üåê Chrome - ‚Üì 800KB/s (‚Üë 150KB/s)
```

**–°–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ü–∞—Ä—Å–∏–Ω–≥ `/proc/net/xt_qtaguid/stats` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
- Fallback –Ω–∞ `/proc/[pid]/net/dev` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –¢—Ä–µ–±—É–µ—Ç elevated permissions (–º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∏—Å—Ç–µ–º–∞-—É—Ä–æ–≤–Ω–µ–≤–∞—è)

---

#### 2.1.4 Network Type Detection
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø —Å–µ—Ç–µ–≤–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–î–µ—Ç–∞–ª–∏:**
- –¢–∏–ø: WiFi / LTE / 5G / Ethernet / None
- –ò–º—è —Å–µ—Ç–∏ (–¥–ª—è WiFi - SSID)
- –°–∏–≥–Ω–∞–ª (–¥–ª—è LTE/5G - dBm, –¥–ª—è WiFi - RSSI)

**–ü—Ä–∏–º–µ—Ä—ã:**
```
WiFi: "LimeHD-Office" (-45 dBm)
LTE: "Megafon" (-110 dBm)
5G: "Beeline-5G" (-95 dBm)
```

---

#### 2.1.5 Traffic Alerts
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –û–ø–æ–≤–µ—â–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ

**–û–ø—Ü–∏–∏:**
- Alert –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ X Mbps
- Alert –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ >Y% daily quota
- Alert –ø—Ä–∏ anomaly detection (—Ç—Ä–∞—Ñ–∏–∫ –≤—ã—à–µ –Ω–æ—Ä–º—ã)
- –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

---

#### 2.1.6 Overlay Display Modes
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∂–∏–º–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ overlay

**–†–µ–∂–∏–º—ã:**
1. **Compact** (—Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º):
   ```
   ‚Üì 2.5M | ‚Üë 0.8M
   ```

2. **Extended**:
   ```
   ‚Üì Ingress: 2.5 Mbps | Peak: 25.3 Mbps
   ‚Üë Egress:  0.8 Mbps | Peak: 12.1 Mbps
   ```

3. **Per-App View**:
   ```
   üé¨ YT: ‚Üì1.5M ‚Üë50K
   üì± TG: ‚Üì200K ‚Üë100K
   üåê CH: ‚Üì800K ‚Üë150K
   ```

4. **Combined** (—Å–æ –≤—Å–µ–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏):
   ```
   CPU: 45% | RAM: 52% | Temp: 38¬∞C
   ‚Üì 2.5M | ‚Üë 0.8M | WiFi: -45dBm
   ```

---

### 2.2 Non-Functional Requirements

#### 2.2.1 Performance
- **CPU overhead**: < 1% (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫ —Ç–µ–∫—É—â–µ–º—É 2%)
- **Memory overhead**: < 20MB –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
- **Battery impact**: < 0.5% –∑–∞ 24 —á–∞—Å–∞ –Ω–∞ —Ñ–æ–Ω–µ
- **Parsing time**: < 100ms per cycle (native C++ optimization)

#### 2.2.2 Accuracy
- ¬±5% –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ (baseline –∏–∑ `ifconfig`)
- –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å `adb shell ifconfig` –Ω–∞ 95%+

#### 2.2.3 Compatibility
- Android 5.0+ (API 21-34)
- –í—Å–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (ARM32, ARM64, x86, x86_64)
- Graceful degradation –µ—Å–ª–∏ `/proc/net/dev` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

#### 2.2.4 Reliability
- –ù–µ –¥–æ–ª–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –∫—Ä–∞—à–µ–π
- –î–æ–ª–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ gracefully
- Fallback –µ—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ñ–∞–π–ª–∞–º

#### 2.2.5 Testability
- Unit tests –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
- Integration tests –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- Benchmark —Ç–µ—Å—Ç—ã –¥–ª—è performance

---

## 3. –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### 3.1 –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Presentation Layer              ‚îÇ
‚îÇ   OverlayView (Network Tab)             ‚îÇ
‚îÇ   NetworkStatsFragment                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           Domain Layer                  ‚îÇ
‚îÇ   GetNetworkStatsUseCase                ‚îÇ
‚îÇ   MonitorNetworkTrafficUseCase          ‚îÇ
‚îÇ   DetectNetworkTypeUseCase              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            Data Layer                   ‚îÇ
‚îÇ   NetworkStatsRepository                ‚îÇ
‚îÇ   NetworkConnectivityRepository         ‚îÇ
‚îÇ   PerAppTrafficRepository               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        Data Sources                     ‚îÇ
‚îÇ   NetworkStatsDataSource (Kotlin)       ‚îÇ
‚îÇ   NativeNetworkStats (C++)              ‚îÇ
‚îÇ   ConnectivityDataSource                ‚îÇ
‚îÇ   /proc/net/dev parsing                 ‚îÇ
‚îÇ   /proc/net/xt_qtaguid/stats parsing    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3.2 Data Flow
```
1. NetworkStatsFlow triggered (every 1s)
   ‚Üì
2. ParsingThread reads /proc/net/dev (C++)
   ‚Üì
3. Calculate delta (bytes_now - bytes_prev)
   ‚Üì
4. Convert to Mbps/kbps
   ‚Üì
5. Update Peak values if needed
   ‚Üì
6. Emit to ViewModel via Flow
   ‚Üì
7. Update UI (overlay + stats screen)
```

### 3.3 Entities & Models

```kotlin
data class NetworkStats(
    val ingressBytesPerSec: Long,      // bytes per second
    val egressBytesPerSec: Long,       // bytes per second
    val ingressMbps: Float,            // display format
    val egressMbps: Float,             // display format
    val peakIngress: Float,            // peak so far
    val peakEgress: Float,             // peak so far
    val peakIngressTime: Long,         // timestamp
    val peakEgressTime: Long,          // timestamp
    val totalIngressBytes: Long,       // cumulative
    val totalEgressBytes: Long,        // cumulative
    val timestamp: Long
)

data class NetworkType(
    val type: NetworkTypeEnum,         // WiFi, LTE, 5G, Ethernet, None
    val displayName: String,           // "WiFi", "LTE", "5G"
    val networkName: String?,          // SSID for WiFi, carrier for LTE
    val signalStrength: Int?           // dBm or RSSI
)

data class PerAppTrafficStats(
    val packageName: String,
    val appName: String,
    val appIcon: Bitmap?,
    val ingressBytesPerSec: Long,
    val egressBytesPerSec: Long,
    val totalIngressBytes: Long,
    val totalEgressBytes: Long
)

enum class NetworkTypeEnum {
    WIFI, LTE, FIVE_G, ETHERNET, NONE
}
```

### 3.4 Key Classes

**NetworkStatsDataSource** (Kotlin):
```kotlin
class NetworkStatsDataSource {
    suspend fun getCurrentNetworkStats(): NetworkStats
    suspend fun getPerAppStats(): List<PerAppTrafficStats>
    fun observeNetworkStats(): Flow<NetworkStats>
}
```

**NativeNetworkStats** (C++):
```cpp
struct NetworkStatsNative {
    unsigned long ingressBytes;
    unsigned long egressBytes;
    unsigned long timestamp;
};

// JNI bridge
NetworkStatsNative getNativeNetworkStats();
```

**NetworkTypeDetector**:
```kotlin
class NetworkTypeDetector(context: Context) {
    fun getCurrentNetworkType(): Flow<NetworkType>
}
```

---

## 4. –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –°–¢–ï–ö

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ü–æ—á–µ–º—É |
|-----------|-----------|--------|
| **–ü–∞—Ä—Å–∏–Ω–≥** | C++ via JNI | 10x –±—ã—Å—Ç—Ä–µ–µ, –Ω–µ—Ç GC –ø–∞—É–∑–µ |
| **Async** | Kotlin Coroutines + Flow | Reactive, non-blocking |
| **DI** | Hilt | Type-safe, compile-time checks |
| **Connectivity** | ConnectivityManager API | Official Android API |
| **Storage** | DataStore | –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è peak stats |
| **Testing** | JUnit4, Mockito, Turbine | –ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |

---

## 5. –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (–§–ê–ó–´)

### –§–ê–ó–ê 1: Core Traffic Monitoring (–Ω–µ–¥–µ–ª—è 1-2)
**Deliverables:**
- ‚úÖ NetworkStatsDataSource (Kotlin –ø–∞—Ä—Å–∏–Ω–≥ /proc/net/dev)
- ‚úÖ Native C++ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ JNI bridge
- ‚úÖ Real-time ingress/egress –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ Peak tracking
- ‚úÖ Unit —Ç–µ—Å—Ç—ã

**Time:** 10-15 —á–∞—Å–æ–≤

---

### –§–ê–ó–ê 2: Network Type Detection (–Ω–µ–¥–µ–ª—è 2)
**Deliverables:**
- ‚úÖ NetworkTypeDetector
- ‚úÖ ConnectivityManager –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ WiFi SSID detection
- ‚úÖ Signal strength parsing
- ‚úÖ –¢–µ—Å—Ç—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–∞—Ö —Å–µ—Ç–µ–π

**Time:** 5-8 —á–∞—Å–æ–≤

---

### –§–ê–ó–ê 3: Per-App Traffic Analysis (–Ω–µ–¥–µ–ª—è 3)
**Deliverables:**
- ‚úÖ PerAppTrafficRepository
- ‚úÖ /proc/net/xt_qtaguid parsing
- ‚úÖ Top 5 apps –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ Per-app icon + name resolution
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å overlay

**Time:** 10-15 —á–∞—Å–æ–≤

---

### –§–ê–ó–ê 4: UI & Overlay Integration (–Ω–µ–¥–µ–ª—è 3-4)
**Deliverables:**
- ‚úÖ Overlay display modes
- ‚úÖ Network stats fragment
- ‚úÖ Settings –¥–ª—è alert'–æ–≤
- ‚úÖ Combined metrics view
- ‚úÖ UI —Ç–µ—Å—Ç—ã

**Time:** 12-18 —á–∞—Å–æ–≤

---

### –§–ê–ó–ê 5: Advanced Features (–Ω–µ–¥–µ–ª—è 4-5)
**Deliverables:**
- ‚úÖ Traffic alerts
- ‚úÖ Anomaly detection
- ‚úÖ Historical data (24-hour)
- ‚úÖ CSV export
- ‚úÖ Performance optimization

**Time:** 15-20 —á–∞—Å–æ–≤

---

### –§–ê–ó–ê 6: Testing & Documentation (–Ω–µ–¥–µ–ª—è 5)
**Deliverables:**
- ‚úÖ Full test coverage (>80%)
- ‚úÖ Performance benchmarks
- ‚úÖ Documentation
- ‚úÖ Code review
- ‚úÖ Release prep

**Time:** 10-12 —á–∞—Å–æ–≤

**–ò–¢–û–ì–û:** 4-5 –Ω–µ–¥–µ–ª—å, ~60-80 —á–∞—Å–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## 6. –ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•

### 6.1 /proc/net/dev (System-wide Traffic)
```
# –ß–∏—Ç–∞–µ–º –∫–∞–∂–¥—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (eth0, wlan0, etc.)
# –ü–æ–ª—É—á–∞–µ–º:
# - Received bytes
# - Transmitted bytes
# - Packets, errors, dropped packets

cat /proc/net/dev

# Output:
# Inter-|   Receive                                                |  Transmit
#  face |bytes    packets errs drop fifo frame compressed multicast|bytes    packets errs drop fifo colls carrier compressed
#    lo: 1234567   12345    0    0    0     0          0         0  1234567   12345    0    0    0     0       0          0
#  eth0: 98765432  654321    0    0    0     0          0         0  87654321  123456    0    0    0     0       0          0
```

### 6.2 /proc/net/xt_qtaguid/stats (Per-App Traffic)
```
# –¢—Ä–µ–±—É–µ—Ç elevated permissions (system app –∏–ª–∏ rooted device)
# –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ UID

cat /proc/net/xt_qtaguid/stats

# Output:
# xtables
# idx iface acct_tag_hex uid_tag_int acct_obj rx_bytes rx_packets tx_bytes tx_packets rx_tcp_packets rx_tcp_bytes rx_udp_packets rx_udp_bytes ...
```

### 6.3 ConnectivityManager API
```kotlin
val connectivityManager = context.getSystemService(Context.CONNECTIVITY_SERVICE) as ConnectivityManager
val network = connectivityManager.activeNetwork
val capabilities = connectivityManager.getNetworkCapabilities(network)

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø
when {
    capabilities.hasTransport(NetworkCapabilities.TRANSPORT_WIFI) -> "WiFi"
    capabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR) -> "LTE/5G"
}
```

---

## 7. –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö –ò EDGE CASES

| –°—Ü–µ–Ω–∞—Ä–∏–π | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| `/proc/net/dev` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω | Fallback –Ω–∞ ConnectivityManager (–º–µ–Ω–µ–µ —Ç–æ—á–Ω–æ) |
| –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å 0 Mbps, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å |
| Per-app stats –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å only system-wide stats |
| Permission denied | Graceful degradation, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫ (>1Gbps) | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π switch –Ω–∞ Gbps –µ–¥–∏–Ω–∏—Ü—ã |
| –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫ (<1Kbps) | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ Kbps, –Ω–µ –¥–æ–ø—É—Å–∫–∞—Ç—å 0 |

---

## 8. PERMISSIONS

```xml
<!-- AndroidManifest.xml -->

<!-- –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ -->
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" /> <!-- For signal strength -->

<!-- –î–ª—è per-app stats (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
<uses-permission android:name="android.permission.PACKAGE_USAGE_STATS" />

<!-- –î–ª—è alerts -->
<uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
```

---

## 9. PERFORMANCE TARGETS

| –ú–µ—Ç—Ä–∏–∫–∞ | Target | –ö–∞–∫ –∏–∑–º–µ—Ä—è—Ç—å |
|---------|--------|---|
| CPU Overhead | < 1% | `adb shell top` –≤–æ –≤—Ä–µ–º—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ |
| Memory Overhead | < 20MB | LeakCanary + Android Studio Profiler |
| Parsing Time | < 100ms | Benchmark —Ç–µ—Å—Ç—ã |
| Battery Impact (bg) | < 0.5%/24h | Drain test –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º device |
| UI Update Lag | < 16ms | Frame time profiling |
| Accuracy | ¬±5% | vs `ifconfig` output |

---

## 10. TESTING STRATEGY

### Unit Tests
```kotlin
class NetworkStatsDataSourceTest {
    @Test fun testParsingValid_DevFile()
    @Test fun testCalculateDelta()
    @Test fun testBytesToMbpsConversion()
    @Test fun testPeakTracking()
    @Test fun testPerAppStatsParsing()
}
```

### Integration Tests
```kotlin
class NetworkStatsIntegrationTest {
    @Test fun testRealDeviceNetworkMonitoring()
    @Test fun testNetworkTypeDetection()
    @Test fun testPerAppTrafficAccuracy()
}
```

### Benchmark Tests
```kotlin
@BenchmarkRule
class NetworkStatsBenchmark {
    @Benchmark fun benchmarkDevFileParsing()
    @Benchmark fun benchmarkPerAppStatsParsing()
    @Benchmark fun benchmarkFullCycle()
}
```

---

## 11. DOCUMENTATION & CODE STANDARDS

### Code Style
- Kotlin style guide (Google)
- Clean Architecture patterns
- SOLID principles
- Comprehensive KDoc comments

### Documentation
- Architecture decision records (ADR)
- API documentation
- Example usage
- Troubleshooting guide

---

## 12. ACCEPTANCE CRITERIA

‚úÖ Real-time ingress/egress –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ Accuracy ¬±5% –æ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞  
‚úÖ CPU overhead < 1%  
‚úÖ Memory overhead < 20MB  
‚úÖ Per-app —Ç—Ä–∞—Ñ–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è (–µ—Å–ª–∏ accessible)  
‚úÖ Network type detection —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ Overlay –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ >80% test coverage  
‚úÖ –ù–µ—Ç –∫—Ä–∞—à–µ–π –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö  
‚úÖ Performance benchmarks –ø—Ä–æ–π–¥–µ–Ω—ã  

---

## 13. RISKS & MITIGATION

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|-----------|
| `/proc/net/xt_qtaguid` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω | High | Medium | Graceful fallback –Ω–∞ system-wide stats |
| Per-app stats —Ç—Ä–µ–±—É—é—Ç root | High | Medium | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É |
| Performance overhead –≤—ã—à–µ —á–µ–º expected | Medium | High | –ó–∞—Ä–∞–Ω–µ–µ benchmark'–∏—Ä–æ–≤–∞—Ç—å, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å C++ |
| Compatibility issues –Ω–∞ —Å—Ç–∞—Ä—ã—Ö Android | Medium | Low | Thorough testing –Ω–∞ API 21+ |

---

## 14. SUCCESS METRICS

- ‚≠ê GitHub stars –∑–∞ —Ñ–∏—á—É (+50 –∑–∞ –º–µ—Å—è—Ü)
- üì• Downloads (–µ—Å–ª–∏ –Ω–∞ Play Store)
- üí¨ Issues (feedback –æ—Ç community)
- ‚ö° Performance (CPU/memory –≤ —Ü–µ–ª–µ–≤—ã—Ö –≥—Ä–∞–Ω–∏—Ü–∞—Ö)
- üß™ Test coverage (>80%)

---

## REFERENCES

- Android `/proc/net/dev` documentation
- Linux `/proc` filesystem guide
- ConnectivityManager API reference
- Android Network Security Configuration
- Performance Best Practices

---

**Author:** Senior Android Developer (15+ years)  
**Date:** December 19, 2025  
**Version:** 1.0  
**Status:** Ready for Claude Opus 4.5 Implementation

